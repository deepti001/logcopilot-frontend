export interface VulnerabilityRecord {
  id: string; // CVE ID
  severity: 'Critical' | 'High' | 'Medium' | 'Low';
  component: string;
  description: string;
  aiRecommendation: string;
  layer?: string; // For single build context
  
  // New fields for enhanced table display
  packageInfo?: {
    name: string;
    installedVersion: string;
    fixedVersion?: string;
  };
  repo?: string;
  image?: string;
  cvssScore?: number;
  
  // Detection tracking
  firstDetected: Date; // When first discovered across all scans
  lastSeen: Date; // Most recent scan where this was found
  detectionHistory: DetectionEvent[];
}

export interface DetectionEvent {
  buildId: string;
  environment: string;
  release: string;
  timestamp: Date;
  scanType: 'scheduled' | 'manual' | 'ci/cd';
  imageInfo: {
    name: string;
    tag: string;
    baseImage: string;
  };
}

export interface VulnerabilityDatabase {
  [cveId: string]: VulnerabilityRecord;
}

export interface BuildScan {
  buildId: string;
  environment: string;
  release: string;
  timestamp: Date;
  imageInfo: {
    name: string;
    tag: string;
    baseImage: string;
  };
  vulnerabilities: string[]; // Array of CVE IDs found in this scan
}